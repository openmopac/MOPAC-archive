\maketitle
\begin{latexonly}
\begin{copyrightnotice}
The contents of this manual may be revised without prior notice\\
All Rights Reserved, Copyright \copyright\ FUJITSU LIMITED 2000
\end{copyrightnotice}
\newpage
\end{latexonly}
\begin{htmlonly}
\begin{center}
\copyrightnotice{The contents of this manual may be revised without prior notice\\
All Rights Reserved, Copyright \copyright\ FUJITSU LIMITED 2000}
\end{center}
\end{htmlonly}
\pagenumbering{roman}
\chapter*{Preface}
\section*{Purpose of this Manual}
\begin{quote}
This manual describes how to use MOPAC~\mopacversion\ (hereinafter called
MOPAC), and includes background material on the theoretical techniques used in
MOPAC.
\end{quote}
\section*{Intended Readers}
\begin{quote}
This manual is written for users of MOPAC.

The reader should have a knowledge of the basic concepts of quantum mechanics
or molecular modeling.
\end{quote}
\section*{Structure of this Manual}
\begin{quote}
The manual has the following format:
\newcounter{chapters}
\setcounter{chapters}{1}

\begin{description}

\item[Chapter \thechapters : Introduction]~\\
An overview of MOPAC is given. The relationships of programs which can be used
with MOPAC are described.
\addtocounter{chapters}{1}

\item[Chapter \thechapters: Acknowledgments]~\\
In this chapter, contributors to MOPAC are recognized.
\addtocounter{chapters}{1}

\item[Chapter \thechapters: Data files for MOPAC]~\\
This chapter describes how to construct data sets for MOPAC, and gives
definitions for the keywords used.
\newcounter{datachapter}  \setcounter{datachapter}{\thechapters}
\addtocounter{chapters}{1}

%\item[Chapter \thechapters: Utility Program MAKPOL]~\\
%The utility program MAKPOL for generating data-sets for solids is described.
%\addtocounter{chapters}{1}

%\item[Chapter \thechapters: Generation of Band Structures]~\\
%The utility program BZ, which generates and analyzes band structures
%in solid-state systems is described.
%\addtocounter{chapters}{1}

%\item[Chapter \thechapters: Calculation of Electron Density]~\\
%The utility program DENSITY, which generates electron density contour
%maps of cross-sections through a system is described.
%\addtocounter{chapters}{1}

\item[Chapter \thechapters: Examples]~\\
Examples of some types of calculations are described.
\addtocounter{chapters}{1}

\item[Chapter \thechapters: Theory]~\\
In this chapter, the theoretical background to several parts of MOPAC
is described.
\newcounter{theorychapter}  \setcounter{theorychapter}{\thechapters}
\addtocounter{chapters}{1}

\item[Chapter \thechapters: Accuracy of Methods in MOPAC]~\\
This chapter gives a quantitative description of the accuracy of MNDO, AM1,
and PM3. The protocols used in minimizing bias are described.
\newcounter{accuracychapter}  \setcounter{accuracychapter}{\thechapters}
\addtocounter{chapters}{1}

\item[Chapter \thechapters: Program]~\\
This chapter describes the structure of the program MOPAC.
\newcounter{programchapter}  \setcounter{programchapter}{\thechapters}
\addtocounter{chapters}{1}

\item[Chapter \thechapters: Error Messages produced by MOPAC]~\\
In this chapter, a brief description is given of some of the error messages
generated by MOPAC.
\newcounter{errorchapter}  \setcounter{errorchapter}{\thechapters}
\addtocounter{chapters}{1}

\item[Chapter \thechapters: Criteria]~\\
In this chapter, the degrees of precision used in various parts of MOPAC
are described.
\addtocounter{chapters}{1}

\item[Chapter \thechapters: Debugging]~\\
This chapter contains notes on how to locate faults in MOPAC.
\addtocounter{chapters}{1}

%\item[Chapter \thechapters: Installing MOPAC]~\\
%This chapter describes how to install MOPAC, and includes information on
%the size of the program and how to port it to other platforms.

\item[Appendices A-C: The Software]~\\
These appendices give reference information about the files and subroutines
which are in MOPAC.

\item[Appendix D: Reference Heats of Formation]~\\
This appendix gives reference heats of formation for compounds of every element
in each method in MOPAC.  This is useful for validating parameter sets.

\item[Appendix E: Bibliography]~\\
This appendix contains a short essay giving references to much of the
material used in MOPAC.
\end{description}
\end{quote}

\section*{How to Read this Manual}
\begin{quote}
\begin{itemize}
%\item The person who installs MOPAC should read Chapter 14.

\item Software developers should read Chapters \thetheorychapter\ and \theprogramchapter,  and Appendices A,
B, and C.

\item Users of MOPAC should read Chapters  \thedatachapter, \thetheorychapter, and \theerrorchapter.

\item People interested in the accuracy of the methods in MOPAC should read
Chapter \theaccuracychapter.

\item People interested in the theory used in MOPAC should read Chapter \thetheorychapter.
\end{itemize}
\end{quote}

\section*{Precautions Concerning this Manual}
\begin{quote}
MOPAC is a research program, and both it and the manual represent the current
state of the science of semiempirical computational chemistry. This is a
rapidly evolving field, and while care has been taken to ensure a high quality
product, the fast pace of development means that many errors may exist in both
the software and in the manual.

Users of MOPAC are also cautioned that the manual concentrates on how to use
the program.  The manual does not describe in detail either what MOPAC can be
used for, or the difficulties which can occur in specific types of jobs.
\end{quote}

\tableofcontents
\listoftables
\listoffigures

\chapter{Introduction}
\pagenumbering{arabic}

\section{What is MOPAC?}\index{MOPAC!definition}
MOPAC is a general-purpose semiempirical molecular orbital package for the
study of solid state and molecular structures and reactions.
\index{ab initio@{{\em ab initio}}}\index{Molecular mechanics}
\index{MNDO}\index{MINDO/3}\index{AM1}\index{PM3}\index{Molecular
orbitals}\index{$\Delta H_f$}\index{Heat of Formation}
\index{Vibrations}\index{Isotopes}
%To a large measure, the methods and  techniques used in MOPAC are due to the
%research work of Prof Michael James Steuart Dewar~\index{Dewar@{\bf Dewar, M.
%J. S.}} and his co-workers.  Due to his vigorous efforts, semiempirical theory
%has improved to the point that today it takes its place as an equal with its
%two partners, the {\em ab initio} methods and molecular mechanics.

The semiempirical Hamiltonians MNDO~\cite{mndo1}, MINDO/3~\cite{mindo3},
AM1~\cite{am1},  PM3~\cite{pm3-1}, and MNDO-$d$~\cite{mndod_0,mndod} are used
in the electronic  part of  the  calculation  to obtain molecular orbitals,
the heat of formation and its derivative with  respect  to  molecular
geometry.   Using  these results   MOPAC   calculates   the   vibrational
spectra,  thermodynamic quantities, isotopic substitution effects and force
constants \index{Force constant} for molecules, radicals, ions, and polymers.
For studying  chemical\index{Radicals}\index{Ions}\index{Polymers} reactions, a
\index{Transition state!location}transition state location routine~\cite{ef-ts}
and two  transition  state optimizing  routines~\cite{nllsq,sigma1,sigma2} are
available.   For users to get the most out of the program, they must understand
how the program works, how to  enter  data, how to interpret the results, and
what to do when things go wrong.

While  MOPAC  calls upon many  concepts in  quantum  theory and thermodynamics
and  uses some fairly advanced mathematics, the user need not be familiar with
these specialized topics.  MOPAC is written with the non-theoretician  in
mind.  The input data are kept as simple as possible, so users can give their
attention  to  the  chemistry  involved  and  not concern themselves with
quantum and thermodynamic exotica.

The simplest description of how MOPAC works is that the user creates a
data-file which describes a molecular system and specifies what kind of
calculations and output are desired.  The user  then  commands  MOPAC  to
carry  out  the  calculation  using  that  data-file.   Finally  the user
extracts the desired output on the system from the output  files  created by
MOPAC.

The name MOPAC should be understood to mean ``Molecular Orbital PACkage". The
origin of the name is somewhat unusual, and might be of general interest: The
original program was written in Austin, Texas. One of the roads in Austin is
unusual in that the Missouri-Pacific railway runs down the middle of the road.
Since this railway was called the MO-PAC, when names for the program were being
considered, MO-PAC was an obvious contender.

\subsection{New Functionalities of MOPAC}
\begin{description}
\item[Addition of $d$-orbitals]~\\
In 1992, W. Thiel and A. A. Voityuk published a  modified MNDO
method~\cite{mndod_0} in which $d$ orbitals were added to  the conventional
$s-p$ basis set. The result of this was a new method, MNDO-$d$, which was more
accurate than any other NDDO method.  For example, using the $s$ and $p$ basis
set only, none of the popular semiempirical methods  correctly predict the
point group for ClF$_3$, whereas when $d$-orbitals are added, the correct
point group is obtained. At present, parameters for only a few main-group
elements are available, namely: Al, Si, P, S, Cl, Br, and I.

Calculations using MNDO-$d$ can be run by use of the new keyword \comp{MNDOD}.
In accordance with the description of the method, for elements for which
MNDO-$d$ parameters are not yet available, MNDO parameters are used by
default.  MNDO-$d$ cannot be used with the solvation methods at present.

Parameters are available for the following transition metals:  Fe, Cu, Ag,
Mo, and Pt, within AM1.
When other transition metal parameter sets become available they
can be used in a MOPAC calculation using the keyword \comp{EXTERNAL}.

The PM3(tm) method is not available by default in MOPAC, but can easily be
added by use of the \comp{EXTERNAL} keyword. See page~\pageref{pm3tm} for details.

\item[Excited States in Solution]~\\
The COSMO method has been extended~\cite{cosmo-rs} to allow calculation of
electronic excited states in solution.  Because the refractive index is needed
in the calculation, it must be supplied in the data set.  Accordingly, the
keyword  \comp{N\*\*=n.nn} has been defined.  Examples of the use of  the COSMO
method are provided in the data sets distributed with MOPAC.

\item[Extension of the Tomasi Model of Solvation]~\\
In earlier versions of MOPAC containing the Tomasi model, a large amount of
data defining the solvent had to be supplied. Three new keywords have now been
defined, which automatically provide default values for common solvents. The
keyword for water is \comp{H2O}.  Recently, the Tomasi method has been extended
to organic solvents.  As a result, two more keywords are provided, \comp{CHCL3}
(for chloroform) )~\cite{chcl3} and \comp{CCL4}  (for carbon
tetrachloride)~\cite{ccl4}.

\item[Dynamic Memory Allocation]~\\
Most of the arrays that depend on the size of the system are now allocated
dynamically.  Previous versions of MOPAC used static memory allocation, and in
order to efficiently run calculations on systems of different  sizes, two or
three different versions of MOPAC had to be available.  With dynamic memory
allocation, a single executable can be used for small, medium, and large
systems.

Not all arrays can be made dynamic.  When MOPAC starts, it does not know how
much memory will be needed for the geometry, so a  few static arrays are
needed.  However, these are relatively small.  Because of this, the default
number of atoms can be set quite large.

\item[Linear Scaling\index{MOZYME!patent}]~\\
A new method, called MOZYME, allows systems of several thousand atoms to be
run  in a practical time.  The method uses localized molecular orbitals, and
gives  results that are the same as those of conventional methods.  MOZYME
should be regarded as an alternative way of solving the SCF equations, that is,
it gives the same results, but by a different method.  Commercial use of the
MOZYME  function is protected by a US patent, number: 5,604,686.  Details of
the patent can be obtained from
\htmladdnormallink{http://patent.womplex.ibm.com/patquery}{http://patent.womplex.ibm.com/patquery}.
Currently, a patent  on this procedure is being applied for in Japan.
\end{description}

\subsection{Technical and Other Changes}
As a result of the steady accumulation of donations, MOPAC had become quite
difficult to modify.  This had tended to discourage users from trying to add
new features.  To correct this, a major re-write of the program has been done.
This involved removing  most of the COMMON blocks, and passing information
between subroutines using two large arrays.

Although the new program has a more complicated information passing method,
once it is learned, the job of adding or modifying functions is greatly
simplified.

Details of the theory and implementation are given in the ``Theory'' section
of the Manual.

\subsection{Cooperative Development of MOPAC}
MOPAC\index{MOPAC!development} has been developed, and hopefully will continue
to be developed, by  the addition  of contributed code. \index{Contributed
code} \index{Code!contributed}  As a policy, any supplied code which is
incorporated into MOPAC will be described in  the  next  release  of  the
Manual,  and  the  author  or  supplier  acknowledged.   In the subsequent
release only journal references will be retained.  The  objective  is  to
produce  a good program.  This is obviously not a one-person undertaking; if it
were, then the product would be poor indeed.  Instead, as we are  in a  time
of rapid change in computational chemistry, a time characterized by a very free
exchange of ideas and code, MOPAC  has  been  evolving  by accretion.   The
unstinting and generous donation of intellectual effort speaks highly of the
donors.

The purpose of having this forum is to facilitate the development of
semiempirical methods.  Because MOPAC has been a public domain program, a large
number of researchers have used it.  Many of these have found defects in it,
and many others have added functionalities which were missing in the original
program.  In an unknown number of instances, different research groups have
added the same functionality. In other words, effort has been duplicated.
Authors of such developments might be reluctant to distribute their
improvements, particularly as frequently the improvements represent a
considerable investment in time and resources. To help avoid this phenomenon of
``re--inventing the wheel'', developers of code are invited to submit their
contribution for inclusion in the next version of MOPAC.

Contributions\index{Contributed code! criteria for} should satisfy one or more
of the following conditions: \index{Criteria!for contributed code}
\begin{itemize}
\item For existing functionalities:
\begin{itemize}
\item A significant increase (minimum of 15\%) in efficiency.
\item The output format should be much easier to read.
\item The accuracy should be increased significantly.
\end{itemize}
\item For new functionalities:
\begin{itemize}
\item A description which would allow users to appreciate the usefulness
of the new functionality must be provided, along with one or more data sets
and results files, and clear instructions on how to use it.
\item For new functionalities which do not involve new data or new results,
a description which would allow users to appreciate the usefulness
of the new functionality must be provided.
\end{itemize}
\item For bug reports:
\begin{itemize}
\item A bug or fault in MOPAC must be identified, and the correction given.
If possible, the effect of the bug should be described.
\end{itemize}
\end{itemize}

In addition, the new code should be provided as part of a complete functioning
MOPAC program.  Exceptions can be made where only a small number of lines of
the original program need to be changed, e.g., a simple bug-fix.

How to acknowledge contributors and report new functionalities presents a
problem. Ideally, new functionalities should first be reported in a more
conventional scientific journal, and only summarized in the QCPE Bulletin.  In
addition, where possible, a description of the new functionality will be added
to the Manual, so that interested users will have a working description in
addition to the regular journal article.

If any errors are found, or if MOPAC does not \index{Bugs!how to
report}perform  as   described,   please   contact:   \\
Dr.~James~J.~P.~Stewart,
Stewart Computational Chemistry, 15210 Paddington Circle, Colorado Springs,
CO 80921-2512, Tel: (719) 488-9416, FAX: (719) 488-9758,
E-mail:
\htmladdnormallink{\comp{jstewart@fujitsu.com}}{mailto:jstewart@fujitsu.com}.

\section{Graphical User Interfaces}
MOPAC does {\em not} have a specific graphical user interface.  The program can
be used on its own, or with an in-house G.U.I, or with a commercial G.U.I.  The
reason for the lack of a specific G.U.I. is simple:  my objective is to produce
a semiempirical computational chemistry `engine'.  This engine can then be
joined, possibly with modifications, to different graphics packages.  In order
to facilitate this, the input and output of MOPAC has been kept as constant as
possible.

Readily available and supported G.U.I.s include:

\begin{description}
\item[WinMOPAC]~\\
WinMOPAC is a GUI specifically designed for use with MOPAC 2000.  It  can be
obtained from  ``WinMOPAC Distributor'', Fujitsu Limited, 1-9-3 Nakase,
Mihama-ku, Chiba 261-8588,  Japan. See
\htmladdnormallink{\comp{http://www.winmopac.com/}}{http://www.winmopac.com/}.  For more
information, contact
\htmladdnormallink{\comp{winmopac@ssd.se.fujitsu.co.jp}}{mailto:winmopac@ssd.se.fujitsu.co.jp},
or call +81(43)299-3236 or fax +81(43)299-3019.

\item[CHEM3D]~\\
The current version of CHEM3D uses MOPAC 97, Revision 2, but the next version
will support MOPAC 2000. Distributor: CambridgeSoft Corporation, 875
Massachusetts Avenue, Cambridge MA 02139; \\
\htmladdnormallink{\comp{http://www.camsoft.com/}}{http://www.camsoft.com/};
E-mail: \htmladdnormallink{\comp{info@camsoft.com}}{mailto:info@camsoft.com};
Tel: (617) 491-2200 and (800) 315-7300; FAX: (617) 491-0555.

%\item{\bf   Insight II}  ?????

\item[HyperChem]~\\
HyperChem has an interface to MOPAC for use on a PC.  This interface simplifies
the construction of molecules and MOPAC input data preparation.  HyperChem
visualization tools can also be used for the analysis of MOPAC  results
(orbitals, vibrations etc).

Distribution and/or contact information:
FQS Poland Sp.\ z o.o.,  ul.\ Starowislna 13-15, 31-038 Krakow, Poland.
\htmladdnormallink{\comp{http://www.fqspl.com.pl/}}{http://www.fqspl.com.pl/}
%
%
%Phone: (+48 12) 429 4345
%Fax:   (+48 12) 429 6124
%Mobile:(+48) 602 452 603
%Email: jerzy@fqspl.com.pl             www.fqspl.com.pl
\end{description}


\section{Use of MOPAC as an Educational tool}
\index{MOPAC!as an educational tool}
\index{Education}
Although MOPAC is designed first and foremost as a research tool, a secondary,
and still important, objective is that it should be suitable for educational
purposes. In order to satisfy the demands of an educational tool, both the
program and the Manual includes material which I hope will be of use to
students.

The following list, while not exhaustive, illustrates the types of topic which
MOPAC can be used for:

\begin{description}
\item[Semiempirical Theory]~\\
Hamiltonian matrices. One and two electron
integrals. Semiempirical methods. Secular determinants. Diagonalization.
Eigenvectors. Eigenvalues. Orthonormalization. Density matrices. Electronic
energy.  $\Delta H_f$. See Section~\ref{semit}.

\item[Symmetry theory]~\\
Point-groups. Irreducible representations. Normal modes. Electronic states.
Symmetry products. Space groups. Little groups.  Complex characters.

\item[Electronic States]~\\
Space and spin quantization. Brillouin's theorem. Configuration interaction.
Shift operators. Spin operators. Franck-Condon principle. Fluorescence.
Red-shift.  Pauli principle.

\item[Normal Coordinates]~\\
Infra-red active modes.  Reduced masses.

\item[Time-dependent phenomena]
\end{description}

\section{A General Description of MOPAC}
\input{features}

\subsection{Citation for MOPAC 2000}
To cite the program, please use:\index{MOPAC!how to cite}
``MOPAC~\mopacversion '', J. J. P. Stewart,  Fujitsu Limited, Tokyo, Japan
(1999).


%\section{Programs recommended for use with MOPAC}
%\index{MOPAC! programs for use with}
%MOPAC is the core program of a series of  programs  for  the  theoretical
%study  of  chemical  phenomena.  This version is the latest in an on-going
%development,  and  efforts  are  being  made  to  continue  its   further
%evolution.  In order to make using MOPAC easier, three other programs have also
%been written.  Users of  MOPAC  are  recommended  to  use  all the programs.
%Efforts  will  be  made  to continue the development of these programs.%%%%%%

%\subsection{BZ} \index{Program!BZ}
%\mi{BZ},  which comes with MOPAC, is used in the analysis of Brillouin Zones.
%It allows points, lines, surfaces, and volumes within the Brillouin Zone to be
%generated.  For points, an analysis allows the irreducible representation of
%the little group of the space group to be generated.

%\subsection{DENSITY}
%$\mi{DENSITY}, which comes with MOPAC,  is  an  electron-density  plotting
%program.  It accepts data-files directly from MOPAC, and  is  intended   to
%be  used  for \index{Program!DENSITY} graphical representation  of  electron
%density distribution,  individual M.O.s, and difference maps.

%Although DENSITY is now quite dated---there are better GUI programs readily
%available---it is still useful as a simple program for stand-alone work.%%%

%\subsection{MAKPOL}\index{Program!MAKPOL}
%\mi{MAKPOL}, which comes with MOPAC, constructs the data-set for  solids.  Such
%data-sets can be made by hand, but are tedious to make, and prone to errors, in
%that the data must be entered in a specific way.  As a result, users who intend
%to use the band-structure capability within the solid-state option, are
%encouraged to also acquire MAKPOL.

\chapter{Acknowledgements}\index{Contributors to
MOPAC}\index{MOPAC!contributors} The following list details all the
contributions to the current MOPAC made by collaborators, co-workers, and
donors of code or ideas.  Users of MOPAC are encouraged to cite donors in their
publications.
\section{Contributors to MOPAC}
\begin{itemize}
\item{\bf Walter Thiel}, Organisch-chemisches Institut
Universit\"{a}t Z\"{u}rich,
Winterthurerstrasse 190,
CH-8057 Z\"{u}rich,
Switzerland, and {\bf Dr Alexander Voityuk},
Lehrstuhl F.\ Theoretische Chemie,
Technische Universit\"{a}t M\"{u}nchen,
Lichtenbergstrasse 4,
D-85747 Garching,
Germany.

The integral evaluation routines for MNDO-$d$ were provided.  These formed the
basis for the MNDO-$d$ method as implemented in MOPAC.


\item {\bf Andreas Klamt}, Bayer AG, Q18, D-5090
Leverkusen-Bayerwerk, Germany.

The COSMO method has been extended to allow electronic excited states of
solvated systems to be calculated.

\item {\bf F.\ Javier Luque, {\em et al}}, Dept.\ Bioquimica, Fac.\ Quimica,
Universitat Barcelona,
Mart\'{\i} i  Franqu\`{e}s 1,
E-08028 Barcelona, Catalunya, Spain.

The Tomasi model was extended to CHCl$_3$ and CCl$_4$.  The data input for
modeling aqueous and organic solvents was considerably simplified.

\item {\bf Josep M.\ Anglada}, C.I.D.-C.S.I.C., Jordi Girona Salgado  18-26,
E-08034 Barcelona, Catalunya, Spain, and {\bf Josep M. Bofill}, Departament de
Qu\'{\i}mica Org\`{a}nica, Universitat de Barcelona, Mart\'{\i} i  Franqu\`{e}s
1, E-08028 Barcelona, Catalunya, Spain.

A method has been added for geometry optimization of a system in which  two
electronic states are constrained to  be degenerate.  This is often referred to
as the minimum energy geometry for intersystem crossing.

%\section{Bug-reports/bug-fixes}
%\begin{itemize}
%?????
%\item Testing of MOPAC:

\item For her unflagging patience in editing  the manual for clarity
of  expression, and ease of use, I thank my wife, Anna.
\index{Stewart@{\bf Stewart, Anna C.}}
\end{itemize}
