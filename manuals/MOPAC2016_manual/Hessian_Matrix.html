<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<TITLE>Calculation of the Hessian matrix</TITLE>
<style type="text/css">.auto-style1 {
	font-family: Symbol;
}
.auto-style3 {
	text-align: center;
}
.auto-style5 {
	text-align: left;
}
.auto-style6 {
	text-align: center;
	border-left-style: none;
	border-left-width: medium;
}
.auto-style8 {
	border-right-style: none;
	border-right-width: medium;
}
.auto-style9 {
	text-align: left;
	border-left-style: none;
	border-left-width: medium;
}
</style>
</HEAD>
<body bgcolor=white>
<h1 align="center">Hessian matrix in <TT><a href="force.html">FORCE</a></TT> calculations 
</h1>
<P>The Hessian matrix is the matrix of second derivatives of the energy with respect to geometry. The most important Hessian is that used in the <TT>FORCE</TT> calculation. Normal modes are expressed as Cartesian displacements, consequently the Hessian is based on Cartesian rather than internal coordinates. 
See also <a href="Vibrational%20Quantities%20-%20Derivation.html">Vibrational 
Relationships - Derivation</a>.</P>
<P>Although first derivatives are relatively easy to calculate, second derivatives are not. The simplest, although not an elegant, way to calculate&nbsp;[<A HREF="references.html#pulayf">73</A>] second derivatives is to calculate first derivatives for a given geometry, then perturb the geometry, do an SCF calculation on the new geometry, and re-calculate the derivatives. The second derivatives can then be calculated from the difference of the two first derivatives divided by the step size. This method, which is used in the EigenFollowing routine, is called 
&quot;single-sided&quot; derivatives. </P>
<P>The Hessian is quite sensitive to geometry, and should only be evaluated at stationary points. Because of this sensitivity, "double-sided" derivatives are used. </P>
<h2><A NAME="SECTION0012141100000000000000">
Calculation of the Hessian matrix</A>
</h2>
The elements of the Hessian are defined as:
<BR>
<DIV ALIGN="CENTER">
<IMG
 WIDTH="87" HEIGHT="48"
 SRC="img1507.gif"
 ALT="\begin{displaymath}H_{i,j} = \frac{\delta^2E}{\delta x_i\delta x_j}
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
and  are generated by use of finite displacements, that is, for each  atomic
coordinate <I>x</I><SUB><I>i</I></SUB>, the coordinate is first incremented by a small amount, &frac12;<span class="auto-style1">D</span>x<sub>j</sub>, the
gradients  calculated, then the coordinate is decremented by
<span class="auto-style1">D</span>x<sub>j</sub> and the gradients
re-calculated. The second derivative is then obtained from the difference of
the two derivatives and the step size:
<BR>
<DIV ALIGN="CENTER">
<IMG
 WIDTH="194" HEIGHT="58"
 SRC="img1508.gif"
 ALT="\begin{displaymath}H_{i,j} = \frac{(\frac{\delta E}{\delta x_i})_{_{+0.5\Delta x...
...rac{\delta E}{\delta x_i})_{_{-0.5\Delta x_j}}}
{\Delta x_j}.
\end{displaymath}">
</DIV>
<div class="auto-style5">
<BR CLEAR="ALL">
This is done for all 3<I>N</I> Cartesian coordinates.  Because the Hessian is
symmetric, that is, because
<I>H</I><SUB><I>i</I>,<I>j</I></SUB>=<I>H</I><SUB><I>j</I>,<I>i</I></SUB>, the random errors that occur in the
gradient calculation can be reduced (by a factor of (1/                            2)<sup>1/2</sup>)
by re-defining
the Hessian as:
<br>
<BR>
</div>
<DIV ALIGN="CENTER">
	<a name="Equation_1:_Construct_Hessian_matrix1">Equation 1: Construct 
	Hessian matrix</a> <br><br>
<IMG
 WIDTH="400" HEIGHT="64"
 SRC="img1510.gif"
 ALT="\begin{displaymath}H_{i,j} = \frac{1}{2}\left(\frac{(\frac{\delta E}{\delta x_i}...
...ta E}{\delta x_j})_{_{-0.5\Delta x_i}}}
{\Delta x_i}\right).
\end{displaymath}">
<br>
</DIV>
<BR CLEAR="ALL">
A call to the energy - gradient function <TT>COMPFG</TT> will generate the
gradients in kcal per mole per &Aring;ngstrom at a given geometry.  The 
resulting second derivatives, in kcal per mole per Ångstrom squared, need to be
converted into millidynes/&Aring;ngstrom (or its equivalent, 10<SUP>5</SUP> dynes/cm).&nbsp; This 
involves an unusual conversion.&nbsp; In the following 
expression, the input is in units of (kcal mol<sup>-1</sup> &Aring;<sup>-2</sup>) 
and the desired units are (millidynes Å<sup>-1</sup>), but dynes have the units 
of (J m<sup>-1</sup>), so only one of the input Å needs to be converted.&nbsp; <br>
<DIV ALIGN="CENTER">
&nbsp;<img height="50" src="img19.gif" width="583"></DIV>
<P>The conversion from (J m<sup>-1</sup>) to millidynes is also unusual in that 
it involves two steps.&nbsp; Expanded, this involves converting (J m<sup>-1</sup>) 
to dynes, followed by converting dynes to millidynes.&nbsp; This involves the 
factors 10<sup>5</sup> times 10<sup>3</sup>, so the total conversion factor is 
10<sup>8</sup>, 
as shown in the following expression:
<BR><P></P>
<DIV ALIGN="CENTER">
	<img height="50" src="img20.gif" width="433">
</DIV>
<BR CLEAR="ALL">
<P></P>
<p>This matrix represents the force constants for the system.&nbsp; In order 
to calculate the vibrational frequencies it must first be
mass-weighted:
<BR></p>
<DIV ALIGN="CENTER">
<IMG
 WIDTH="110" HEIGHT="48"
 SRC="img1513.gif"
 ALT="\begin{displaymath}H^m_{i,j} = \frac{H_{i,j}}{\sqrt{M_i*M_j}}.
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P>In this expression, <em>M<sub>i</sub></em> and <em>M<sub>j</sub></em> are the 
atomic weights in amu, so for a nitrogen molecule&nbsp; <em>M<sub>i</sub></em> =&nbsp; <em>M<sub>j</sub></em>&nbsp; 
= 
14.0067.</P>
<P>
Diagonalization of this matrix yields eigenvalues, <i>&epsilon;</i><sub>i</sub>, from which the vibrational frequencies, &nu;<sub>i</sub> can be calculated.&nbsp; For simple harmonic motion 
involving a mass, <em>m</em>, and force-constant, <em>k</em>, the frequency, <i>
f</i>, in cycles per second is given by:<P class="auto-style3">
<em>f</em> = 1/(2&pi;) x (<em>k/m</em>)<sup>&frac12; </sup>cycles per 
second<P class="auto-style5">
But, by convention, vibrational frequencies in UV-Visible spectroscopy are 
reported in reciprocal centimeters.&nbsp; To convert from <em>f</em> to <em>&nu;</em>, <em>f</em> must be divided by the speed of light, c. <P class="auto-style3">
<table align="center">
	<tr>
		<td class="auto-style8" style="width: 12px">&nu;</td>
		<td class="auto-style9">= <em>f</em>/c</td>
	</tr>
	<tr>
		<td class="auto-style8" style="width: 12px">&nbsp;</td>
		<td class="auto-style9">= 1/(2&#960;c) x (<em>k/m</em>)<sup>&frac12; </sup></td>
	</tr>
	<tr>
		<td class="auto-style8" style="width: 12px">&nbsp;</td>
		<td class="auto-style6">= 1/(2&#960;c) x (<em>&epsilon;</em><sub>i</sub>)<sup>&frac12; </sup>cm<sup><sup>-1</sup></sup></td>
	</tr>
	<tr>
		<td style="width: 12px">&nbsp;</td>
		<td>&nbsp;</td>
	</tr>
</table>
<P class="auto-style5">
At this point, some quantities are not in the correct units. The eigenvalues are in millidynes per &Aring;ngstrom 
per amu.&nbsp; Before they can be used they must be converted into SI units, 
by using:<br>1 millidyne per Ångstrom = 10<sup>2</sup> J m<sup>-2</sup>,<br>Atomic 
mass units (amu) = 10<sup>-3 </sup>x<sup> </sup>N<sup>-1</sup> kilograms.&nbsp; 
<P class="auto-style5">
Combining these two factors together:<P class="auto-style3">
&nbsp;Millidynes per Angstrom per amu = (10<sup>2</sup> x 10<sup>3</sup> 
x N) J m<sup>-2</sup> 
kg<sup>-1</sup> = (10<sup>5</sup> x N) Newton m<sup>-1</sup> 
kg<sup>-1</sup> <P class="auto-style5">
Once this is done, the frequency in cm<sup>-1</sup> can be calculated:<table align="center">
	<tr>
		<td><em>&nu;</em>&nbsp;</td>
		<td>= 1/(2&#960;c)(10<sup>5</sup> x N<i> </i>x <i> &epsilon;</i>)<sup>&frac12;</sup></td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td>= 1/(2 x 3.1416 x 2.9979 x 10<sup>10</sup>)) x (6.022 x 10<sup>28</sup> 
		x <em>&epsilon;</em>)&frac12;</td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td>= 1302.79 x <em>&epsilon;</em><sup>&frac12;</sup> cm<sup>-1</sup></td>
	</tr></table>

<P>
The eigenvalue also represents the quantity (<i>k/&mu;</i>)<sup>1/2</sup> , where <em>k</em> 
is the force constant and <i>&#956; </i>is the reduced mass, but further discussion of this will be 
left until later.
</BODY>
</HTML>