<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.1 release (February 19th, 1998)
originally by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Calculation of the Hessian matrix</TITLE>
<META NAME="description" CONTENT="Calculation of the Hessian matrix">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">

<LINK REL="previous" HREF="node585.html">
<LINK REL="up" HREF="node585.html">
<LINK REL="next" HREF="node587.html">
</HEAD>
<body bgcolor=white>
<!--Navigation Panel-->
<A NAME="tex2html9416"
 HREF="node587.html">
<IMG ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif" width="37" height="24"></A> 
<A NAME="tex2html9412"
 HREF="node585.html">
<IMG ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif" width="26" height="24"></A> 
<A NAME="tex2html9408"
 HREF="node585.html">
<IMG ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif" width="63" height="24"></A> 
<A NAME="tex2html9414"
 HREF="index.html">
<IMG ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents_motif.gif" width="65" height="24"></A> 
<A NAME="tex2html9415"
 HREF="node716.html">
<IMG ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif" width="43" height="24"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html9417"
 HREF="node587.html"> Mechanism of the</A>
<B> Up:</B> <A NAME="tex2html9413"
 HREF="node585.html"> Calculation of Vibrational</A>
<B> Previous:</B> <A NAME="tex2html9409"
 HREF="node585.html"> Calculation of Vibrational</A>
<BR>
<BR>
<!--End of Navigation Panel-->
<H3><A NAME="SECTION0012141100000000000000">
Calculation of the Hessian matrix</A>
</H3>
The elements of the Hessian are defined as:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH: \begin{displaymath}
H_{i,j} = \frac{\delta^2E}{\delta x_i\delta x_j}
\end{displaymath} -->
<IMG
 WIDTH="87" HEIGHT="48"
 SRC="img1507.gif"
 ALT="\begin{displaymath}H_{i,j} = \frac{\delta^2E}{\delta x_i\delta x_j}
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
and  are generated by use of finite displacements, that is, for each  atomic
coordinate <I>x</I><SUB><I>i</I></SUB>, the coordinate is first incremented by a small amount, the
gradients  calculated, then the coordinate is decremented and the gradients
re-calculated. The second derivative is then obtained from the difference of
the two derivatives and the step size:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH: \begin{displaymath}
H_{i,j} = \frac{(\frac{\delta E}{\delta x_i})_{_{+0.5\Delta x_j}}-
(\frac{\delta E}{\delta x_i})_{_{-0.5\Delta x_j}}}
          {\Delta x_j}.
\end{displaymath} -->
<IMG
 WIDTH="194" HEIGHT="58"
 SRC="img1508.gif"
 ALT="\begin{displaymath}H_{i,j} = \frac{(\frac{\delta E}{\delta x_i})_{_{+0.5\Delta x...
...rac{\delta E}{\delta x_i})_{_{-0.5\Delta x_j}}}
{\Delta x_j}.
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
This is done for all 3<I>N</I> Cartesian coordinates.  Because the Hessian is
symmetric, that is 
<!-- MATH: $H_{i,j}=H_{j,i}$ -->
<I>H</I><SUB><I>i</I>,<I>j</I></SUB>=<I>H</I><SUB><I>j</I>,<I>i</I></SUB>, the random errors that occur in the
gradient calculation can be reduced (by a factor of (1/<!-- MATH: $\sqrt{2}D_2$ -->2)<sup>1/2</sup>)
by re-defining
the Hessian as:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH: \begin{displaymath}
H_{i,j} = \frac{1}{2}\left(\frac{(\frac{\delta E}{\delta x_i})_{_{+0.5\Delta x_j}}-
(\frac{\delta E}{\delta x_i})_{_{-0.5\Delta x_j}}}
          {\Delta x_j}+
 \frac{(\frac{\delta E}{\delta x_j})_{_{+0.5\Delta x_i}}-
                (\frac{\delta E}{\delta x_j})_{_{-0.5\Delta x_i}}} 
          {\Delta x_i}\right).
\end{displaymath} -->
<IMG
 WIDTH="400" HEIGHT="64"
 SRC="img1510.gif"
 ALT="\begin{displaymath}H_{i,j} = \frac{1}{2}\left(\frac{(\frac{\delta E}{\delta x_i}...
...ta E}{\delta x_j})_{_{-0.5\Delta x_i}}}
{\Delta x_i}\right).
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
A call to the energy - gradient function <TT>COMPFG</TT> will generate the
gradients in kcal/mol/&#197;ngstrom at a given geometry.  These can then be
converted into millidynes/&#197;ngstrom (or 10<SUP>5</SUP> dynes/cm) as follows:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH: \begin{displaymath}
H_{i,j} (\mathrm{millidynes/\AA}) = 10^5\frac{({\mathrm{Kcal\ to\
ergs}})}{(\mathrm{\AA\ to\ cm})^2(\mathrm{Mole\ to\ molecule})}H_{i,j}(\mathrm{kcal/mol/\AA ^2 })
\end{displaymath} -->
<IMG
 WIDTH="467" HEIGHT="45"
 SRC="img1511.gif"
 ALT="\begin{displaymath}H_{i,j} (\mathrm{millidynes/\AA}) = 10^5\frac{({\mathrm{Kcal\...
...athrm{Mole\ to\ molecule})}H_{i,j}(\mathrm{kcal/mol/\AA ^2 })
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
or
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH: \begin{displaymath}
H_{i,j} (\mathrm{millidynes/\AA}) = 10^5\frac{4.184*10^3*10^7}{(10^{-8*2})
(6.022*10^{23})}H_{i,j}(\mathrm{kcal/mol/\AA ^2}).
\end{displaymath} -->
<IMG
 WIDTH="425" HEIGHT="45"
 SRC="img1512.gif"
 ALT="\begin{displaymath}H_{i,j} (\mathrm{millidynes/\AA}) = 10^5\frac{4.184*10^3*10^7}{(10^{-8*2})
(6.022*10^{23})}H_{i,j}(\mathrm{kcal/mol/\AA ^2}).
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
Diagonalization of this matrix yields the force constants of the system.
<P>
In order to calculate the vibrational frequencies, the Hessian matrix is first 
mass-weighted:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH: \begin{displaymath}
H^m_{i,j} = \frac{H_{i,j}}{\sqrt{M_i*M_j}}.
\end{displaymath} -->
<IMG
 WIDTH="110" HEIGHT="48"
 SRC="img1513.gif"
 ALT="\begin{displaymath}H^m_{i,j} = \frac{H_{i,j}}{\sqrt{M_i*M_j}}.
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
<P>
Then the Hessian is converted from millidynes per &#197;ngstrom to dynes per 
centimeter by multiplying by 10<SUP>5</SUP>.
<P>
Diagonalization of this matrix yields eigenvalues, <i><font face="Symbol">e</font></i>,
which represent 
the quantities 
<!-- MATH: $\sqrt{k/\mu}$ -->
(<i>k/<font face="Symbol">m</font></i>)<sup>1/2</sup> ,
from which the vibrational frequencies can be
calculated:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH: \begin{displaymath}
\bar{\nu}_i = \frac{1}{2\pi c}\sqrt{\epsilon_i}.
\end{displaymath} -->
<IMG
 WIDTH="84" HEIGHT="39"
 SRC="img1516.gif"
 ALT="\begin{displaymath}\bar{\nu}_i = \frac{1}{2\pi c}\sqrt{\epsilon_i}.
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html9416"
 HREF="node587.html">
<IMG ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif" width="37" height="24"></A> 
<A NAME="tex2html9412"
 HREF="node585.html">
<IMG ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif" width="26" height="24"></A> 
<A NAME="tex2html9408"
 HREF="node585.html">
<IMG ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif" width="63" height="24"></A> 
<A NAME="tex2html9414"
 HREF="index.html">
<IMG ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents_motif.gif" width="65" height="24"></A> 
<A NAME="tex2html9415"
 HREF="node716.html">
<IMG ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif" width="43" height="24"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html9417"
 HREF="node587.html"> Mechanism of the</A>
<B> Up:</B> <A NAME="tex2html9413"
 HREF="node585.html"> Calculation of Vibrational</A>
<B> Previous:</B> <A NAME="tex2html9409"
 HREF="node585.html"> Calculation of Vibrational</A>
<!--End of Navigation Panel-->
<ADDRESS>
<I>J. J. P. Stewart</I>
<BR><I>Fujitsu Ltd. 2001</I>
</ADDRESS>
</BODY>
</HTML>